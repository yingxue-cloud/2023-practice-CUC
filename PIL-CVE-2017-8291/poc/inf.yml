# 用于展示给用户的标题
title: Python Pillow remote command execution vulnerability
# 漏洞编号（CVE/CAN/BUGTRAQ/CNCVE/CNVD/CNNVD...）
number: CVE-2017-8291
# 漏洞类型：从以下类型中选取
# 资源开发：Resource Development
# 初始访问：Initial Access
# 执行：Execution
# 持久控制：Persistence
# 提权：Privilege Escalation
# 绕过防御：Defense Evasion
# 凭证访问：Credential Access
# 发现：Discovery
# 横向渗透：Lateral Movement
# 信息收集：Collection
# 命令控制：Command and Control
# 信息盗取：Exfiltration
# 造成的影响：Impact
type: Execution
# 漏洞评分
score: 7.8
# 目标类型
target: 
  # 目标可在此操作系统运行
  os: 
    Windows: true
    AIX: false
    Linux: true
    Solaris: true
    BSD: false
    UNIX: true
    VxWorks: false
  # 目标所属应用程序类别
  app:
    web: false
    E-mail: false
    FTP: false
    database: false
    middleware: false
    other: ~
  # 目标是否可存在于硬件防火墙、入侵检测系统、路由器和交换机
  hardware:
    Firewall: false
    IDS: false
    router: false
    switch: false
  # 目标如果属于数据库，对应数据库产品
  Oracle: false
  MySQL: false
  SQL Server: false
  DM7: false
  DM8: false
  DB2: false
  Informix: false
  Gbase: false
  PostgreSQL: false
  SQLlite: false
  MariaDB: false
  MS-SQL: false

# 对漏洞的描述
vul_description: Python中处理图片的模块PIL,因为其内部调用了GhostScript而受到GhostButt漏洞(CVE-2017-8291)的影响,造成远程命令执行漏洞。
# 对漏洞利用效果的描述
exp_effect: 远程执行
# 漏洞影响的版本范围（格式要求：软件名 版本号）
affect_version: GhostScript versions 9.21 and earlier
# 脚本来源
source: https://github.com/vulhub/vulhub/tree/master/python/PIL-CVE-2017-8291
# 来源认定漏洞危险等级
level: HIGH
# 脚本语言
language: 
  Ruby: false
  Perl: false
  Python: true
  PHP: false
  Java: false
  JavaScript: false
  other: ~
# 环境依赖
dependence: python
# 脚本存储路径(相对路径)
path: exp/PIL_CVE-2017-8291_python/exp.png
# 备注（运行方式或任何提示）
help: |-  #给出运行示例命令行(Example)+具体的帮助信息(Usage)
  Example: 在http://localhost:8000/ 里上传图片
  Usage:
    http://localhost:8000/  上传exp/PIL_CVE-2017-8291_python/exp.png图片
    即可在目标机器执行插入在图片里的命令