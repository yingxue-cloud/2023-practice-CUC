# 用于展示给用户的标题
title: Mysql Authentication Vulnerability
# 漏洞编号（CVE/CAN/BUGTRAQ/CNCVE/CNVD/CNNVD...）
number: CVE-2012-2122
# 漏洞类型：从以下类型中选取
# 资源开发：Resource Development
# 初始访问：Initial Access
# 执行：Execution
# 持久控制：Persistence
# 提权：Privilege Escalation
# 绕过防御：Defense Evasion
# 凭证访问：Credential Access
# 发现：Discovery
# 横向渗透：Lateral Movement
# 信息收集：Collection
# 命令控制：Command and Control
# 信息盗取：Exfiltration
# 造成的影响：Impact
type: Defense Evasion
# 漏洞评分
score: 5.1
# 目标类型
target: 
  # 目标可在此操作系统运行
  os: 
    Windows: true
    AIX: true
    Linux: true
    Solaris: true
    BSD: true
    UNIX: true
    VxWorks: false
  # 目标所属应用程序类别
  app:
    web: false
    E-mail: false
    FTP: false
    database: true
    middleware: false
    other: ~
  # 目标是否可存在于硬件防火墙、入侵检测系统、路由器和交换机
  hardware:
    Firewall: false
    IDS: false
    router: false
    switch: false
  # 目标如果属于数据库，对应数据库产品
  Oracle: true
  MySQL: true
  SQL Server: false
  DM7: false
  DM8: false
  DB2: false
  Informix: false
  Gbase: false
  PostgreSQL: false
  SQLlite: false
  MariaDB: true
  MS-SQL: false

# 对漏洞的描述
vul_description: 当连接MariaDB/MySQL时,输入的密码会与期望的正确密码比较,由于不正确的处理,会导致即便是memcmp()返回一个非零值,也会使MySQL认为两个密码是相同的。
# 对漏洞利用效果的描述
exp_effect: 越权访问
# 漏洞影响的版本范围（格式要求：软件名 版本号）
affect_version: MariaDB versions from 5.1.62, 5.2.12, 5.3.6, 5.5.23 are not/MySQL versions from 5.1.63, 5.5.24, 5.6.6 are not
# 脚本来源
source: https://github.com/vulhub/vulhub/tree/master/mysql/CVE-2012-2122
# 来源认定漏洞危险等级
level: MEDIUM
# 脚本语言
language: 
  Ruby: false
  Perl: false
  Python: false
  PHP: false
  Java: false
  JavaScript: false
  other: ~
# 环境依赖
dependence: bash
# 脚本存储路径(相对路径)
path: exp/CVE-2012-2122_mysql/exp.sh
# 备注（运行方式或任何提示）
help: |-  #给出运行示例命令行(Example)+具体的帮助信息(Usage)
  Example: bash exp/CVE-2012-2122_mysql/exp.sh
  Usage:
    python3 exp/Linux_cve-2017-12611_python/exp.py http://target:8080/hello.action
    成功即可登录mysql