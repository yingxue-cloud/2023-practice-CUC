# 用于展示给用户的标题
title: Struts2 S2-061 Remote Code Execution Vulnerablity
# 漏洞编号（CVE/CAN/BUGTRAQ/CNCVE/CNVD/CNNVD...）
number: CVE-2020-17530
# 漏洞类型：从以下类型中选取
# 资源开发：Resource Development
# 初始访问：Initial Access
# 执行：Execution
# 持久控制：Persistence
# 提权：Privilege Escalation
# 绕过防御：Defense Evasion
# 凭证访问：Credential Access
# 发现：Discovery
# 横向渗透：Lateral Movement
# 信息收集：Collection
# 命令控制：Command and Control
# 信息盗取：Exfiltration
# 造成的影响：Impact
type: Execution
# 漏洞评分
score: 9.8
# 目标类型
target: 
  # 目标可在此操作系统运行
  os: 
    Windows: true
    AIX: false
    Linux: true
    Solaris: false
    BSD: false
    UNIX: true
    VxWorks: false
  # 目标所属应用程序类别
  app:
    web: true
    E-mail: false
    FTP: false
    database: false
    middleware: false
    other: ~
  # 目标是否可存在于硬件防火墙、入侵检测系统、路由器和交换机
  hardware:
    Firewall: false
    IDS: false
    router: false
    switch: false
  # 目标如果属于数据库，对应数据库产品
  Oracle: false
  MySQL: false
  SQL Server: false
  DM7: false
  DM8: false
  DB2: false
  Informix: false
  Gbase: false
  PostgreSQL: false
  SQLlite: false
  MariaDB: false
  MS-SQL: false

# 对漏洞的描述
vul_description: Struts2是一个基于MVC设计模式的Web应用框架,在MVC设计模式中,Struts2作为控制器(Controller)来建立模型与视图的数据交互。 action元素没有设置名称空间属性,或者使用了通配符名称空间将由用户从uri传递并解析为OGNL表达式,最终导致远程代码执行漏洞。
# 对漏洞利用效果的描述
exp_effect: 远程命令执行
# 漏洞影响的版本范围（格式要求：软件名 版本号）
affect_version: Struts2 versions from 2.0.0 to 2.5.25
# 脚本来源
source: https://github.com/vulhub/vulhub/tree/master/struts2/s2-061
# 来源认定漏洞危险等级
level: CRITICAL
# 脚本语言
language: 
  Ruby: false
  Perl: false
  Python: true
  PHP: false
  Java: false
  JavaScript: false
  other: ~
# 环境依赖
dependence: python
# 脚本存储路径(相对路径)
path: exp/CVE-2017-8291_java/exp.py
# 备注（运行方式或任何提示）
help: |-  #给出运行示例命令行(Example)+具体的帮助信息(Usage)
  Example: python exp/CVE-2017-8291_java/exp.py
  Usage:
    python exp/CVE-2017-8291_java/exp.py
    即可在系统返回值中查看命令执行结果